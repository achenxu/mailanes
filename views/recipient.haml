%h2
  Recipient
  = succeed ':' do
    = "##{recipient.id}"

%p
  It is
  %strong
    - if recipient.active?
      %span.green active
    - else
      %span.red not active
  = '/'
  %a{href: "/toggle-recipient?list=#{list.id}&id=#{recipient.id}"}
    - if recipient.active?
      deactivate
    - else
      activate

%p
  = succeed ':' do
    %a{href: "/list?id=#{list.id}"}= "List ##{list.id}"
  &= "\"#{list.title}\""
  - if current_user != list.owner
    = "(owned by @#{current_user})"

%p
  Email:
  %code
    = recipient.email

- if !recipient.first.empty?
  %p
    First:
    = recipient.first

- if !recipient.last.empty?
  %p
    Last:
    = recipient.last

%p
  Created:
  = recipient.created.utc.iso8601
  = "(#{TimeDifference.between(recipient.created, Time.now).humanize} ago)"

%p
  Source:
  = recipient.source

%pre= recipient.yaml.to_yaml

%form{method: 'POST', action: '/comment-recipient'}
  %input{type: 'hidden', name: 'list', value: list.id}
  %input{type: 'hidden', name: 'id', value: recipient.id}
  %input{type: 'text', name: 'comment', placeholder: 'What just happened?...', size: 50, required: 'true', autocomplete: 'off'}
  %input{type: 'submit', value: 'Comment'}

- deliveries = recipient.deliveries
- if deliveries.empty?
  %p
    No delivery reports as of yet.
- else
  - deliveries.each do |d|
    %p
      %a{href: "/delivery?id=#{d.id}"}= "##{d.id}"
      = '/'
      = d.created.utc.iso8601
      = "(#{TimeDifference.between(d.created, Time.now).humanize} ago)"
      with letter
      %a{href: "/letter?id=#{d.letter.id}"}= "##{d.letter.id}"
      in campaign
      %a{href: "/campaign?id=#{d.campaign.id}"}= "##{d.campaign.id}"
      = d.relax ? "(relax is #{d.relax})" : ''
      = ':'
      &= d.details.empty? ? 'WAITING' : d.details
